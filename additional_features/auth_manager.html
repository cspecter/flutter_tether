<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-additional_features/auth_manager" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Auth Manager | Flutter Tether</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://flutterTether.github.io/flutter_tether/img/ft-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://flutterTether.github.io/flutter_tether/img/ft-social-card.jpg"><meta data-rh="true" property="og:url" content="https://flutterTether.github.io/flutter_tether/additional_features/auth_manager"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Auth Manager | Flutter Tether"><meta data-rh="true" name="description" content="The AuthManager is a crucial helper class within the Tether ecosystem,"><meta data-rh="true" property="og:description" content="The AuthManager is a crucial helper class within the Tether ecosystem,"><link data-rh="true" rel="icon" href="/flutter_tether/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://flutterTether.github.io/flutter_tether/additional_features/auth_manager"><link data-rh="true" rel="alternate" href="https://flutterTether.github.io/flutter_tether/additional_features/auth_manager" hreflang="en"><link data-rh="true" rel="alternate" href="https://flutterTether.github.io/flutter_tether/additional_features/auth_manager" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Additional Features","item":"https://flutterTether.github.io/flutter_tether/category/additional-features"},{"@type":"ListItem","position":2,"name":"Auth Manager","item":"https://flutterTether.github.io/flutter_tether/additional_features/auth_manager"}]}</script><link rel="stylesheet" href="/flutter_tether/assets/css/styles.0f514b2e.css">
<script src="/flutter_tether/assets/js/runtime~main.fa54d0ae.js" defer="defer"></script>
<script src="/flutter_tether/assets/js/main.f7ca60a1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/flutter_tether/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/flutter_tether/"><div class="navbar__logo"><img src="/flutter_tether/img/logo.svg" alt="Flutter Tether Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/flutter_tether/img/logo.svg" alt="Flutter Tether Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Flutter Tether</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/flutter_tether/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/cspecter/flutter_tether" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/intro">About Tether</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/schema">Schema Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/models">Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/select_builders">Select Builders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/managers">Managers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/full_text_search">Full Text Search</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/flutter_tether/category/additional-features">Additional Features</a><button aria-label="Collapse sidebar category &#x27;Additional Features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flutter_tether/additional_features/feed_provider">Feed Management System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/flutter_tether/additional_features/auth_manager">Auth Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flutter_tether/additional_features/user_preferences_manager">User Preferences Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flutter_tether/additional_features/background_manager">Background Service: Background Job Processing</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/flutter_tether/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/flutter_tether/category/additional-features"><span>Additional Features</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Auth Manager</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Auth Manager</h1></header>
<p>The <code>AuthManager</code> is a crucial helper class within the Tether ecosystem,
designed to simplify user authentication and the management of an associated
user profile. It wraps the Supabase authentication API and provides automatic
caching of a user&#x27;s profile data from a specified table in your Supabase
<code>public</code> schema to a local SQLite table.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p><code>AuthManager</code> streamlines common authentication workflows by:</p>
<ul>
<li>Providing standard methods for <strong>sign-up, sign-in (with password or OTP), and
sign-out</strong>.</li>
<li>Listening to <strong>Supabase authentication state changes</strong> (<code>onAuthStateChange</code>).</li>
<li>Automatically <strong>fetching the user&#x27;s profile</strong> from a designated Supabase table
upon successful authentication.</li>
<li><strong>Storing and updating</strong> the user&#x27;s profile in a corresponding local SQLite
table.</li>
<li><strong>Clearing local profile data</strong> on sign-out or if the profile fetch fails.</li>
<li>Exposing <code>ValueNotifier</code>s for the current Supabase <code>User</code> and the locally
cached <code>TProfileModel</code> (your user profile model), enabling reactive UI
updates.</li>
</ul>
<p>The key assumption is that your user profile table in Supabase:</p>
<ol>
<li>Resides in the <code>public</code> schema.</li>
<li>Has a primary key column (typically named <code>id</code>) that matches the <code>id</code> of the
Supabase authenticated user (<code>auth.users.id</code>).</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup--configuration">Setup &amp; Configuration<a href="#setup--configuration" class="hash-link" aria-label="Direct link to Setup &amp; Configuration" title="Direct link to Setup &amp; Configuration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-configure-tetheryaml">1. Configure <code>tether.yaml</code><a href="#1-configure-tetheryaml" class="hash-link" aria-label="Direct link to 1-configure-tetheryaml" title="Direct link to 1-configure-tetheryaml">​</a></h3>
<p>Enable authentication in your <code>tether.yaml</code> configuration file:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">generation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">authentication</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">profile_table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;profiles&#x27;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Name of your Supabase profile table</span><br></span></code></pre></div></div>
<p>This tells Tether to generate the <code>AuthManager</code> class and related providers for
the specified profile table.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-generated-files">2. Generated Files<a href="#2-generated-files" class="hash-link" aria-label="Direct link to 2. Generated Files" title="Direct link to 2. Generated Files">​</a></h3>
<p>When you run <code>dart run tether --config tether.yaml</code>, Tether will generate:</p>
<ul>
<li><strong><code>lib/database/managers/auth_manager.g.dart</code></strong>: The core
<code>AuthManager&lt;TProfileModel&gt;</code> class</li>
<li><strong><code>lib/database/providers/auth_providers.g.dart</code></strong>: Riverpod providers for
easy integration</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-database-schema-requirements">3. Database Schema Requirements<a href="#3-database-schema-requirements" class="hash-link" aria-label="Direct link to 3. Database Schema Requirements" title="Direct link to 3. Database Schema Requirements">​</a></h3>
<p>Your Supabase profile table should:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Example profiles table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> profiles </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id UUID </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REFERENCES</span><span class="token plain"> auth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">users</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DELETE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CASCADE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    username </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UNIQUE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    full_name </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avatar_url </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    created_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TIME</span><span class="token plain"> ZONE </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    updated_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TIME</span><span class="token plain"> ZONE </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Enable RLS (Row Level Security)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> profiles </span><span class="token keyword" style="color:#00009f">ENABLE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROW</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LEVEL</span><span class="token plain"> SECURITY</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Policy to allow users to view and update their own profile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> POLICY </span><span class="token string" style="color:#e3116c">&quot;Users can view own profile&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> profiles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">auth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">uid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> POLICY </span><span class="token string" style="color:#e3116c">&quot;Users can update own profile&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> profiles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">auth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">uid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-with-riverpod">Usage with Riverpod<a href="#usage-with-riverpod" class="hash-link" aria-label="Direct link to Usage with Riverpod" title="Direct link to Usage with Riverpod">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-setup">Basic Setup<a href="#basic-setup" class="hash-link" aria-label="Direct link to Basic Setup" title="Direct link to Basic Setup">​</a></h3>
<p>The generated providers make it easy to use <code>AuthManager</code> throughout your app:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Access the AuthManager instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final authManager = ref.watch(authManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Watch the current authenticated user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final userAsyncValue = ref.watch(currentUserProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Watch the current user&#x27;s profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final profileAsyncValue = ref.watch(currentProfileProvider);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-methods">Authentication Methods<a href="#authentication-methods" class="hash-link" aria-label="Direct link to Authentication Methods" title="Direct link to Authentication Methods">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sign-up">Sign Up<a href="#sign-up" class="hash-link" aria-label="Direct link to Sign Up" title="Direct link to Sign Up">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class SignUpWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final authManager = ref.watch(authManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return ElevatedButton(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      onPressed: () async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          final response = await authManager.signUp(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            email: &#x27;user@example.com&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            password: &#x27;securepassword123&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            data: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &#x27;username&#x27;: &#x27;newuser&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &#x27;full_name&#x27;: &#x27;New User&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }, // Optional additional data for the auth.users table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          if (response.user != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Sign up successful - user will need to confirm email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              SnackBar(content: Text(&#x27;Check your email to confirm account&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } on AuthException catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SnackBar(content: Text(&#x27;Sign up failed: ${e.message}&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      child: Text(&#x27;Sign Up&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sign-in-with-password">Sign In with Password<a href="#sign-in-with-password" class="hash-link" aria-label="Direct link to Sign In with Password" title="Direct link to Sign In with Password">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class SignInWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final authManager = ref.watch(authManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return ElevatedButton(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      onPressed: () async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          await authManager.signInWithPassword(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            email: &#x27;user@example.com&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            password: &#x27;password123&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          // On success, profile will be fetched and cached automatically</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Navigator.pushReplacementNamed(context, &#x27;/home&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } on AuthException catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SnackBar(content: Text(&#x27;Sign in failed: ${e.message}&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      child: Text(&#x27;Sign In&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sign-in-with-otp-magic-link">Sign In with OTP (Magic Link)<a href="#sign-in-with-otp-magic-link" class="hash-link" aria-label="Direct link to Sign In with OTP (Magic Link)" title="Direct link to Sign In with OTP (Magic Link)">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class OTPSignInWidget extends ConsumerStatefulWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _OTPSignInWidgetState createState() =&gt; _OTPSignInWidgetState();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class _OTPSignInWidgetState extends ConsumerState&lt;OTPSignInWidget&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final _emailController = TextEditingController();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final _otpController = TextEditingController();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  bool _otpSent = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final authManager = ref.watch(authManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!_otpSent) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        children: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          TextField(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            controller: _emailController,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            decoration: InputDecoration(labelText: &#x27;Email&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ElevatedButton(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            onPressed: () async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                await Supabase.instance.client.auth.signInWithOtp(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  email: _emailController.text,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                setState(() =&gt; _otpSent = true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  SnackBar(content: Text(&#x27;Check your email for the OTP code&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              } on AuthException catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  SnackBar(content: Text(&#x27;Error: ${e.message}&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            child: Text(&#x27;Send OTP&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      children: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TextField(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          controller: _otpController,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          decoration: InputDecoration(labelText: &#x27;Enter OTP Code&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ElevatedButton(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          onPressed: () async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              await authManager.signInWithOtp(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                email: _emailController.text,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                token: _otpController.text,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              Navigator.pushReplacementNamed(context, &#x27;/home&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } on AuthException catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SnackBar(content: Text(&#x27;OTP verification failed: ${e.message}&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          child: Text(&#x27;Verify OTP&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TextButton(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          onPressed: () async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              await authManager.resendOtp(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                email: _emailController.text,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type: OtpType.email,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SnackBar(content: Text(&#x27;OTP resent&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } on AuthException catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ScaffoldMessenger.of(context).showSnackBar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SnackBar(content: Text(&#x27;Resend failed: ${e.message}&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          child: Text(&#x27;Resend OTP&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sign-out">Sign Out<a href="#sign-out" class="hash-link" aria-label="Direct link to Sign Out" title="Direct link to Sign Out">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class SignOutWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final authManager = ref.watch(authManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return ElevatedButton(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      onPressed: () async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await authManager.signOut();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Navigator.pushReplacementNamed(context, &#x27;/login&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      child: Text(&#x27;Sign Out&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reactive-ui-with-authentication-state">Reactive UI with Authentication State<a href="#reactive-ui-with-authentication-state" class="hash-link" aria-label="Direct link to Reactive UI with Authentication State" title="Direct link to Reactive UI with Authentication State">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="auth-state-wrapper">Auth State Wrapper<a href="#auth-state-wrapper" class="hash-link" aria-label="Direct link to Auth State Wrapper" title="Direct link to Auth State Wrapper">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class AuthWrapper extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final userAsyncValue = ref.watch(currentUserProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return userAsyncValue.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: (user) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (user != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return HomeScreen(); // User is authenticated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return LoginScreen(); // User is not authenticated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      loading: () =&gt; Scaffold(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body: Center(child: CircularProgressIndicator()),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error: (error, stack) =&gt; Scaffold(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body: Center(child: Text(&#x27;Error: $error&#x27;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="profile-display">Profile Display<a href="#profile-display" class="hash-link" aria-label="Direct link to Profile Display" title="Direct link to Profile Display">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class ProfileWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final profileAsyncValue = ref.watch(currentProfileProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final userAsyncValue = ref.watch(currentUserProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return profileAsyncValue.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: (profile) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (profile != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            children: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              Text(&#x27;Welcome, ${profile.fullName ?? profile.username}!&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              if (profile.avatarUrl != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                CircleAvatar(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  backgroundImage: NetworkImage(profile.avatarUrl!),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              Text(&#x27;Email: ${profile.email}&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return userAsyncValue.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            data: (user) =&gt; user != null </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ? Text(&#x27;Profile not found&#x27;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              : Text(&#x27;Not signed in&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            loading: () =&gt; CircularProgressIndicator(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            error: (error, stack) =&gt; Text(&#x27;Error: $error&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      loading: () =&gt; CircularProgressIndicator(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error: (error, stack) =&gt; Text(&#x27;Profile error: $error&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-without-riverpod">Usage without Riverpod<a href="#usage-without-riverpod" class="hash-link" aria-label="Direct link to Usage without Riverpod" title="Direct link to Usage without Riverpod">​</a></h2>
<p>If you&#x27;re not using Riverpod, you can still use <code>AuthManager</code> directly:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class AuthService {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  late final AuthManager&lt;ProfileModel&gt; _authManager;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthService() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _authManager = AuthManager&lt;ProfileModel&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      supabaseClient: Supabase.instance.client,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      localDb: yourSqliteConnection, // Your SQLite connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      supabaseProfileTableName: &#x27;profiles&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      localProfileTableName: &#x27;profiles&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      profileFromJsonFactory: ProfileModel.fromJson,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tableSchemas: globalSupabaseSchema, // Your generated schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Listen to authentication state changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _authManager.currentUserNotifier.addListener(_onUserChanged);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _authManager.currentProfileNotifier.addListener(_onProfileChanged);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void _onUserChanged() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final user = _authManager.currentUserNotifier.value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;User changed: ${user?.id}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void _onProfileChanged() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final profile = _authManager.currentProfileNotifier.value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Profile changed: ${profile?.username}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Future&lt;void&gt; signIn(String email, String password) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _authManager.signInWithPassword(email: email, password: password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Future&lt;void&gt; signOut() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _authManager.signOut();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void dispose() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _authManager.dispose();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-features--notes">Key Features &amp; Notes<a href="#key-features--notes" class="hash-link" aria-label="Direct link to Key Features &amp; Notes" title="Direct link to Key Features &amp; Notes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-profile-synchronization">Automatic Profile Synchronization<a href="#automatic-profile-synchronization" class="hash-link" aria-label="Direct link to Automatic Profile Synchronization" title="Direct link to Automatic Profile Synchronization">​</a></h3>
<ul>
<li><strong>On Sign In</strong>: Profile is automatically fetched from Supabase and cached
locally</li>
<li><strong>On Token Refresh</strong>: Profile is re-fetched to ensure it&#x27;s up-to-date</li>
<li><strong>On Sign Out</strong>: Local profile data is automatically cleared</li>
<li><strong>On Profile Not Found</strong>: Local data is cleared and
<code>currentProfileNotifier.value</code> becomes <code>null</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="local-caching-strategy">Local Caching Strategy<a href="#local-caching-strategy" class="hash-link" aria-label="Direct link to Local Caching Strategy" title="Direct link to Local Caching Strategy">​</a></h3>
<ul>
<li>Uses a <strong>single-user approach</strong>: Only one profile is stored locally at a time</li>
<li><strong>Delete and Insert</strong>: When a new profile is fetched, existing local data is
deleted first</li>
<li><strong>Automatic Cleanup</strong>: Local data is cleared on sign-out or authentication
errors</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling">Error Handling<a href="#error-handling" class="hash-link" aria-label="Direct link to Error Handling" title="Direct link to Error Handling">​</a></h3>
<ul>
<li><strong>Network Errors</strong>: Gracefully handled with logging; local data is cleared on
fetch failures</li>
<li><strong>Schema Mismatches</strong>: Logged with clear error messages</li>
<li><strong>Authentication Errors</strong>: Propagated as <code>AuthException</code> from Supabase</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h3>
<ol>
<li><strong>Always dispose</strong>: Call <code>authManager.dispose()</code> when no longer needed
(handled automatically with Riverpod providers)</li>
<li><strong>Profile table structure</strong>: Ensure your profile table&#x27;s <code>id</code> matches
<code>auth.users.id</code></li>
<li><strong>Row Level Security</strong>: Enable RLS on your profile table for security</li>
<li><strong>Error boundaries</strong>: Wrap authentication calls in try-catch blocks</li>
<li><strong>Loading states</strong>: Use the reactive providers to show appropriate loading
states in your UI</li>
</ol></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/flutter_tether/additional_features/feed_provider"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Feed Management System</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/flutter_tether/additional_features/user_preferences_manager"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">User Preferences Manager</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#setup--configuration" class="table-of-contents__link toc-highlight">Setup &amp; Configuration</a><ul><li><a href="#1-configure-tetheryaml" class="table-of-contents__link toc-highlight">1. Configure <code>tether.yaml</code></a></li><li><a href="#2-generated-files" class="table-of-contents__link toc-highlight">2. Generated Files</a></li><li><a href="#3-database-schema-requirements" class="table-of-contents__link toc-highlight">3. Database Schema Requirements</a></li></ul></li><li><a href="#usage-with-riverpod" class="table-of-contents__link toc-highlight">Usage with Riverpod</a><ul><li><a href="#basic-setup" class="table-of-contents__link toc-highlight">Basic Setup</a></li><li><a href="#authentication-methods" class="table-of-contents__link toc-highlight">Authentication Methods</a></li><li><a href="#reactive-ui-with-authentication-state" class="table-of-contents__link toc-highlight">Reactive UI with Authentication State</a></li></ul></li><li><a href="#usage-without-riverpod" class="table-of-contents__link toc-highlight">Usage without Riverpod</a></li><li><a href="#key-features--notes" class="table-of-contents__link toc-highlight">Key Features &amp; Notes</a><ul><li><a href="#automatic-profile-synchronization" class="table-of-contents__link toc-highlight">Automatic Profile Synchronization</a></li><li><a href="#local-caching-strategy" class="table-of-contents__link toc-highlight">Local Caching Strategy</a></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error Handling</a></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Chad Specter.</div></div></div></footer></div>
</body>
</html>