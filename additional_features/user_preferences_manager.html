<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-additional_features/user_preferences_manager" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">User Preferences Manager | Flutter Tether</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://flutterTether.github.io/flutter_tether/img/ft-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://flutterTether.github.io/flutter_tether/img/ft-social-card.jpg"><meta data-rh="true" property="og:url" content="https://flutterTether.github.io/flutter_tether/additional_features/user_preferences_manager"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="User Preferences Manager | Flutter Tether"><meta data-rh="true" name="description" content="The UserPreferencesManager is a powerful utility class generated by Tether"><meta data-rh="true" property="og:description" content="The UserPreferencesManager is a powerful utility class generated by Tether"><link data-rh="true" rel="icon" href="/flutter_tether/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://flutterTether.github.io/flutter_tether/additional_features/user_preferences_manager"><link data-rh="true" rel="alternate" href="https://flutterTether.github.io/flutter_tether/additional_features/user_preferences_manager" hreflang="en"><link data-rh="true" rel="alternate" href="https://flutterTether.github.io/flutter_tether/additional_features/user_preferences_manager" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Additional Features","item":"https://flutterTether.github.io/flutter_tether/category/additional-features"},{"@type":"ListItem","position":2,"name":"User Preferences Manager","item":"https://flutterTether.github.io/flutter_tether/additional_features/user_preferences_manager"}]}</script><link rel="stylesheet" href="/flutter_tether/assets/css/styles.0f514b2e.css">
<script src="/flutter_tether/assets/js/runtime~main.2fada5db.js" defer="defer"></script>
<script src="/flutter_tether/assets/js/main.c4f0b1ee.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/flutter_tether/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/flutter_tether/"><div class="navbar__logo"><img src="/flutter_tether/img/logo.svg" alt="Flutter Tether Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/flutter_tether/img/logo.svg" alt="Flutter Tether Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Flutter Tether</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/flutter_tether/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/cspecter/flutter_tether" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/intro">About Tether</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/schema">Schema Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/models">Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/select_builders">Select Builders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/managers">Managers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/full_text_search">Full Text Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/config">Configuration Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/flutter_tether/category/additional-features">Additional Features</a><button aria-label="Collapse sidebar category &#x27;Additional Features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flutter_tether/additional_features/feed_provider">Feed Management System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flutter_tether/additional_features/auth_manager">Auth Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/flutter_tether/additional_features/user_preferences_manager">User Preferences Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flutter_tether/additional_features/background_manager">Background Service: Background Job Processing</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/flutter_tether/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/flutter_tether/category/additional-features"><span>Additional Features</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">User Preferences Manager</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>User Preferences Manager</h1></header>
<p>The <code>UserPreferencesManager</code> is a powerful utility class generated by Tether
that provides a type-safe, reactive way to store and manage user preferences in
your Flutter application. It uses a local SQLite database to persist key-value
pairs with automatic JSON serialization/deserialization and supports streaming
updates for reactive UI components.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p><code>UserPreferencesManager</code> simplifies user preference management by:</p>
<ul>
<li><strong>Type-Safe Storage</strong>: Store any JSON-serializable data with the help of the
<code>UserPreferenceValueType</code> enum.</li>
<li><strong>Automatic Serialization</strong>: Handles JSON encoding/decoding automatically.</li>
<li><strong>Reactive Streams</strong>: Watch preferences for real-time UI updates using
<code>watchPreference</code>.</li>
<li><strong>Default Values</strong>: Easily set up default preferences on first app launch with
<code>ensureDefaultPreferences</code>.</li>
<li><strong>Rich Data Types</strong>: Support for primitives, arrays, and complex objects.</li>
<li><strong>Upsert Operations</strong>: <code>setPreference</code> automatically creates or updates
preferences.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="supported-data-types">Supported Data Types<a href="#supported-data-types" class="hash-link" aria-label="Direct link to Supported Data Types" title="Direct link to Supported Data Types">​</a></h2>
<p>The manager supports various data types through the <code>UserPreferenceValueType</code>
enum:</p>
<table><thead><tr><th>Type</th><th>Enum Value</th><th>String Constant (DB)</th><th>Use Case</th><th>Example Value (Dart)</th><th><code>fromJson</code> Example (jsonData as Type)</th></tr></thead><tbody><tr><td>Text</td><td><code>text</code></td><td><code>&#x27;text&#x27;</code></td><td>Simple strings</td><td><code>&quot;User Name&quot;</code></td><td><code>jsonData as String?</code></td></tr><tr><td>Integer</td><td><code>integer</code></td><td><code>&#x27;integer&#x27;</code></td><td>Whole numbers</td><td><code>123</code></td><td><code>jsonData as int?</code></td></tr><tr><td>Number</td><td><code>number</code></td><td><code>&#x27;number&#x27;</code></td><td>Decimal/floating-point</td><td><code>3.14159</code></td><td><code>(jsonData as num?)?.toDouble()</code></td></tr><tr><td>Boolean</td><td><code>boolean</code></td><td><code>&#x27;boolean&#x27;</code></td><td>True/false values</td><td><code>true</code></td><td><code>jsonData as bool?</code></td></tr><tr><td>DateTime</td><td><code>datetime</code></td><td><code>&#x27;datetime&#x27;</code></td><td>Date and time values</td><td><code>&quot;2023-10-27T10:00:00Z&quot;</code></td><td><code>jsonData == null ? null : DateTime.parse(jsonData as String)</code></td></tr><tr><td>Text Array</td><td><code>stringList</code></td><td><code>&#x27;stringList&#x27;</code></td><td>Lists of strings</td><td><code>[&#x27;apple&#x27;, &#x27;banana&#x27;]</code></td><td><code>jsonData == null ? null : List&lt;String&gt;.from(jsonData as List)</code></td></tr><tr><td>Integer Array</td><td><code>integerArray</code></td><td><code>&#x27;integerArray&#x27;</code></td><td>Lists of whole numbers</td><td><code>[1, 2, 3]</code></td><td><code>jsonData == null ? null : List&lt;int&gt;.from(jsonData as List)</code></td></tr><tr><td>Number Array</td><td><code>numberArray</code></td><td><code>&#x27;numberArray&#x27;</code></td><td>Lists of decimal numbers</td><td><code>[1.1, 2.2, 3.3]</code></td><td><code>jsonData == null ? null : List&lt;double&gt;.from((jsonData as List).map((e) =&gt; (e as num).toDouble()))</code></td></tr><tr><td>JSON Object</td><td><code>jsonObject</code></td><td><code>&#x27;jsonObject&#x27;</code></td><td>Complex structured objects</td><td><code>{&#x27;key&#x27;: &#x27;value&#x27;, &#x27;count&#x27;: 1}</code></td><td><code>jsonData == null ? null : Map&lt;String, dynamic&gt;.from(jsonData as Map)</code></td></tr><tr><td>JSON Array</td><td><code>jsonArray</code></td><td><code>&#x27;jsonArray&#x27;</code></td><td>Lists of complex objects</td><td><code>[{&#x27;id&#x27;:1}, {&#x27;id&#x27;:2}]</code></td><td><code>jsonData == null ? null : List&lt;dynamic&gt;.from(jsonData as List)</code></td></tr><tr><td>Text Array</td><td><code>textArray</code></td><td><code>&#x27;textArray&#x27;</code></td><td>Lists of strings (alternative to <code>stringList</code>)</td><td><code>[&#x27;itemA&#x27;, &#x27;itemB&#x27;]</code></td><td><code>jsonData == null ? null : List&lt;String&gt;.from(jsonData as List)</code></td></tr></tbody></table>
<p><strong>Note:</strong></p>
<ul>
<li>The &quot;Enum Value&quot; column shows the actual enum case (e.g.,
<code>UserPreferenceValueType.text</code>).</li>
<li>The &quot;String Constant (DB)&quot; column shows the string representation used for
storage in the database (e.g., <code>&#x27;text&#x27;</code>).</li>
<li><code>stringList</code> and <code>textArray</code> both represent an array of strings. <code>stringList</code>
might be present for historical reasons or specific use cases, while
<code>textArray</code> is a more explicit name. Choose one consistently or as per your
project&#x27;s convention. The generated <code>userPreferenceValueTypeToString</code> function
might map both to the same string (e.g., &quot;textArray&quot;) for database storage.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup--configuration">Setup &amp; Configuration<a href="#setup--configuration" class="hash-link" aria-label="Direct link to Setup &amp; Configuration" title="Direct link to Setup &amp; Configuration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-enable-in-configuration">1. Enable in Configuration<a href="#1-enable-in-configuration" class="hash-link" aria-label="Direct link to 1. Enable in Configuration" title="Direct link to 1. Enable in Configuration">​</a></h3>
<p>Ensure User Preferences are enabled in your <code>tether.yaml</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># tether.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">generation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># ... other settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">user_preferences</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Enables generation of UserPreferencesManager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># If using Riverpod, ensure providers are enabled:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">client_managers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">use_riverpod</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-generated-files">2. Generated Files<a href="#2-generated-files" class="hash-link" aria-label="Direct link to 2. Generated Files" title="Direct link to 2. Generated Files">​</a></h3>
<p>Tether generates:</p>
<ul>
<li><strong><code>lib/database/managers/user_preferences_manager.g.dart</code></strong>: The core manager
class</li>
<li><strong>Database migration</strong>: Creates the <code>user_preferences</code> table automatically</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-database-schema">3. Database Schema<a href="#3-database-schema" class="hash-link" aria-label="Direct link to 3. Database Schema" title="Direct link to 3. Database Schema">​</a></h3>
<p>The manager uses this SQLite table structure:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> user_preferences </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    preference_key </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    preference_value </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">-- JSON-encoded value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    value_type </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">-- One of UserPreferenceValueType</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    created_at </span><span class="token keyword" style="color:#00009f">INTEGER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unixepoch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    updated_at </span><span class="token keyword" style="color:#00009f">INTEGER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unixepoch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-usage">Basic Usage<a href="#basic-usage" class="hash-link" aria-label="Direct link to Basic Usage" title="Direct link to Basic Usage">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-the-manager">Accessing the Manager<a href="#accessing-the-manager" class="hash-link" aria-label="Direct link to Accessing the Manager" title="Direct link to Accessing the Manager">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// With Riverpod (recommended)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Direct instantiation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final prefsManager = UserPreferencesManager(yourSqliteDatabase);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-preferences">Setting Preferences<a href="#setting-preferences" class="hash-link" aria-label="Direct link to Setting Preferences" title="Direct link to Setting Preferences">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="simple-values">Simple Values<a href="#simple-values" class="hash-link" aria-label="Direct link to Simple Values" title="Direct link to Simple Values">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Store a string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;username&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;john_doe&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.text,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Store a boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;notifications_enabled&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.boolean,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Store a number (float/double)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;user_score&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  85.5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.number,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Store a DateTime (as ISO8601 string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;last_login&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DateTime.now().toIso8601String(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.datetime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="complex-objects">Complex Objects<a href="#complex-objects" class="hash-link" aria-label="Direct link to Complex Objects" title="Direct link to Complex Objects">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Store an object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class UserSettings {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final String theme;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final bool darkMode;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final List&lt;String&gt; languages;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UserSettings({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    required this.theme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    required this.darkMode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    required this.languages,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Map&lt;String, dynamic&gt; toJson() =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;theme&#x27;: theme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;darkMode&#x27;: darkMode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;languages&#x27;: languages,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  factory UserSettings.fromJson(Map&lt;String, dynamic&gt; json) =&gt; UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    theme: json[&#x27;theme&#x27;] as String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    darkMode: json[&#x27;darkMode&#x27;] as bool,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    languages: List&lt;String&gt;.from(json[&#x27;languages&#x27;] as List),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Store the settings object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final settings = UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  theme: &#x27;blue&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  darkMode: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  languages: [&#x27;en&#x27;, &#x27;es&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference&lt;Map&lt;String, dynamic&gt;&gt;( // Explicitly type T for complex objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  settings.toJson(), // Value must be JSON encodable (e.g., Map&lt;String, dynamic&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.jsonObject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arrays">Arrays<a href="#arrays" class="hash-link" aria-label="Direct link to Arrays" title="Direct link to Arrays">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Store a list of strings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference&lt;List&lt;String&gt;&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;favorite_categories&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [&#x27;technology&#x27;, &#x27;sports&#x27;, &#x27;music&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.stringList, // or .textArray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Store a list of numbers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference&lt;List&lt;double&gt;&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;graph_points&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [10.2, 15.5, 12.0],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.numberArray,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Store a list of objects (maps)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final recentSearches = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {&#x27;query&#x27;: &#x27;flutter&#x27;, &#x27;timestamp&#x27;: DateTime.now().millisecondsSinceEpoch},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {&#x27;query&#x27;: &#x27;dart&#x27;, &#x27;timestamp&#x27;: DateTime.now().millisecondsSinceEpoch},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference&lt;List&lt;Map&lt;String, dynamic&gt;&gt;&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;recent_searches&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  recentSearches,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.jsonArray,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-preferences">Getting Preferences<a href="#getting-preferences" class="hash-link" aria-label="Direct link to Getting Preferences" title="Direct link to Getting Preferences">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="simple-values-1">Simple Values<a href="#simple-values-1" class="hash-link" aria-label="Direct link to Simple Values" title="Direct link to Simple Values">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Get a string, providing a default if null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final username = await prefsManager.getPreference&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;username&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) =&gt; jsonData as String? ?? &#x27;Guest&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get a boolean, providing a default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final notificationsEnabled = await prefsManager.getPreference&lt;bool&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;notifications_enabled&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) =&gt; jsonData as bool? ?? true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get a number (double), providing a default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final userScore = await prefsManager.getPreference&lt;double&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;user_score&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) =&gt; (jsonData as num?)?.toDouble() ?? 0.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get a DateTime (parsed from ISO8601 string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final lastLogin = await prefsManager.getPreference&lt;DateTime?&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;last_login&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) =&gt; jsonData == null ? null : DateTime.tryParse(jsonData as String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="complex-objects-1">Complex Objects<a href="#complex-objects-1" class="hash-link" aria-label="Direct link to Complex Objects" title="Direct link to Complex Objects">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Get an object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final settings = await prefsManager.getPreference&lt;UserSettings?&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (jsonData == null) return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return UserSettings.fromJson(jsonData as Map&lt;String, dynamic&gt;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get with fallback to a default instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final settingsWithDefault = await prefsManager.getPreference&lt;UserSettings&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (jsonData == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return UserSettings(theme: &#x27;default&#x27;, darkMode: false, languages: [&#x27;en&#x27;]); // Default instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return UserSettings.fromJson(jsonData as Map&lt;String, dynamic&gt;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arrays-1">Arrays<a href="#arrays-1" class="hash-link" aria-label="Direct link to Arrays" title="Direct link to Arrays">​</a></h4>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Get a list of strings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final categories = await prefsManager.getPreference&lt;List&lt;String&gt;&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;favorite_categories&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) =&gt; jsonData != null </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ? List&lt;String&gt;.from(jsonData as List) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    : &lt;String&gt;[], // Default to empty list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get a list of maps (representing objects)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final searches = await prefsManager.getPreference&lt;List&lt;Map&lt;String, dynamic&gt;&gt;&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;recent_searches&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (jsonData) =&gt; jsonData != null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ? List&lt;Map&lt;String, dynamic&gt;&gt;.from(jsonData as List)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    : &lt;Map&lt;String, dynamic&gt;&gt;[], // Default to empty list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reactive-ui-with-riverpod-providers">Reactive UI with Riverpod Providers<a href="#reactive-ui-with-riverpod-providers" class="hash-link" aria-label="Direct link to Reactive UI with Riverpod Providers" title="Direct link to Reactive UI with Riverpod Providers">​</a></h2>
<p>For the most seamless integration with your app&#x27;s state management, create
Riverpod providers that wrap your preference streams:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="simple-preference-providers">Simple Preference Providers<a href="#simple-preference-providers" class="hash-link" aria-label="Direct link to Simple Preference Providers" title="Direct link to Simple Preference Providers">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Create providers for commonly used preferences</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final notificationsEnabledProvider = StreamProvider&lt;bool&gt;((ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return prefsManager.watchPreference&lt;bool&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;notifications_enabled&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJson: (json) =&gt; json as bool? ?? true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final userThemeProvider = StreamProvider&lt;String&gt;((ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return prefsManager.watchPreference&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;theme&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJson: (json) =&gt; json as String? ?? &#x27;default&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final favoriteCategories = StreamProvider&lt;List&lt;String&gt;&gt;((ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return prefsManager.watchPreference&lt;List&lt;String&gt;&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;favorite_categories&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJson: (json) =&gt; json != null </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ? List&lt;String&gt;.from(json as List) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      : &lt;String&gt;[],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="complex-object-providers">Complex Object Providers<a href="#complex-object-providers" class="hash-link" aria-label="Direct link to Complex Object Providers" title="Direct link to Complex Object Providers">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final userSettingsProvider = StreamProvider&lt;UserSettings&gt;((ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return prefsManager.watchPreference&lt;UserSettings&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJson: (json) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (json == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          theme: &#x27;default&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          darkMode: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          languages: [&#x27;en&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return UserSettings.fromJson(json as Map&lt;String, dynamic&gt;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-providers-in-widgets">Using Providers in Widgets<a href="#using-providers-in-widgets" class="hash-link" aria-label="Direct link to Using Providers in Widgets" title="Direct link to Using Providers in Widgets">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class NotificationToggle extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final notificationsAsync = ref.watch(notificationsEnabledProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return notificationsAsync.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: (isEnabled) =&gt; SwitchListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        title: Text(&#x27;Enable Notifications&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value: isEnabled,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        onChanged: (value) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;notifications_enabled&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            value,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            valueType: UserPreferenceValueType.boolean,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      loading: () =&gt; ListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        title: Text(&#x27;Enable Notifications&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        trailing: CircularProgressIndicator(strokeWidth: 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error: (error, stack) =&gt; ListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        title: Text(&#x27;Enable Notifications&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        subtitle: Text(&#x27;Error: $error&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ThemeSelector extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final settingsAsync = ref.watch(userSettingsProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return settingsAsync.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: (settings) =&gt; Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        children: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            title: Text(&#x27;Theme&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            trailing: DropdownButton&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              value: settings.theme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              items: [&#x27;default&#x27;, &#x27;blue&#x27;, &#x27;green&#x27;].map((theme) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                DropdownMenuItem(value: theme, child: Text(theme))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ).toList(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              onChanged: (newTheme) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (newTheme != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  final updatedSettings = UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    theme: newTheme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    darkMode: settings.darkMode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    languages: settings.languages,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    updatedSettings.toJson(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    valueType: UserPreferenceValueType.jsonObject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          SwitchListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            title: Text(&#x27;Dark Mode&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            value: settings.darkMode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            onChanged: (value) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              final updatedSettings = UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                theme: settings.theme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                darkMode: value,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                languages: settings.languages,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                updatedSettings.toJson(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                valueType: UserPreferenceValueType.jsonObject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      loading: () =&gt; Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        children: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            title: Text(&#x27;Theme&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            trailing: CircularProgressIndicator(strokeWidth: 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            title: Text(&#x27;Dark Mode&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            trailing: CircularProgressIndicator(strokeWidth: 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error: (error, stack) =&gt; ListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        title: Text(&#x27;Settings Error&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        subtitle: Text(error.toString()),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provider-family-for-dynamic-keys">Provider Family for Dynamic Keys<a href="#provider-family-for-dynamic-keys" class="hash-link" aria-label="Direct link to Provider Family for Dynamic Keys" title="Direct link to Provider Family for Dynamic Keys">​</a></h3>
<p>For preferences with dynamic keys, use a provider family:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final dynamicPreferenceProvider = StreamProvider.family&lt;String, String&gt;((ref, key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return prefsManager.watchPreference&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJson: (json) =&gt; json as String? ?? &#x27;&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class DynamicPreferenceWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final String preferenceKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const DynamicPreferenceWidget({required this.preferenceKey});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final valueAsync = ref.watch(dynamicPreferenceProvider(preferenceKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return valueAsync.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: (value) =&gt; Text(&#x27;$preferenceKey: $value&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      loading: () =&gt; CircularProgressIndicator(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error: (error, stack) =&gt; Text(&#x27;Error: $error&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reactive-ui-with-streambuilder-alternative">Reactive UI with StreamBuilder (Alternative)<a href="#reactive-ui-with-streambuilder-alternative" class="hash-link" aria-label="Direct link to Reactive UI with StreamBuilder (Alternative)" title="Direct link to Reactive UI with StreamBuilder (Alternative)">​</a></h2>
<p>If you prefer using StreamBuilder directly instead of Riverpod providers:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="watching-simple-preferences">Watching Simple Preferences<a href="#watching-simple-preferences" class="hash-link" aria-label="Direct link to Watching Simple Preferences" title="Direct link to Watching Simple Preferences">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class NotificationToggle extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return StreamBuilder&lt;bool&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stream: prefsManager.watchPreference&lt;bool&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;notifications_enabled&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fromJson: (json) =&gt; json as bool? ?? true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      builder: (context, snapshot) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final isEnabled = snapshot.data ?? true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return SwitchListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          title: Text(&#x27;Enable Notifications&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          value: isEnabled,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          onChanged: (value) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &#x27;notifications_enabled&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              value,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              valueType: UserPreferenceValueType.boolean,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="watching-complex-objects">Watching Complex Objects<a href="#watching-complex-objects" class="hash-link" aria-label="Direct link to Watching Complex Objects" title="Direct link to Watching Complex Objects">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class ThemeSelector extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return StreamBuilder&lt;UserSettings?&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stream: prefsManager.watchPreference&lt;UserSettings?&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fromJson: (json) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          if (json == null) return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return UserSettings.fromJson(json as Map&lt;String, dynamic&gt;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      builder: (context, snapshot) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final settings = snapshot.data ?? UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          theme: &#x27;default&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          darkMode: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          languages: [&#x27;en&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          children: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              title: Text(&#x27;Theme: ${settings.theme}&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              trailing: DropdownButton&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                value: settings.theme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                items: [&#x27;default&#x27;, &#x27;blue&#x27;, &#x27;green&#x27;].map((theme) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  DropdownMenuItem(value: theme, child: Text(theme))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ).toList(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                onChanged: (newTheme) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  if (newTheme != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    final updatedSettings = UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      theme: newTheme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      darkMode: settings.darkMode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      languages: settings.languages,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      updatedSettings.toJson(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      valueType: UserPreferenceValueType.jsonObject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SwitchListTile(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              title: Text(&#x27;Dark Mode&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              value: settings.darkMode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              onChanged: (value) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                final updatedSettings = UserSettings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  theme: settings.theme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  darkMode: value,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  languages: settings.languages,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  updatedSettings.toJson(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  valueType: UserPreferenceValueType.jsonObject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-preferences">Default Preferences<a href="#default-preferences" class="hash-link" aria-label="Direct link to Default Preferences" title="Direct link to Default Preferences">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-defaults">Setting Up Defaults<a href="#setting-up-defaults" class="hash-link" aria-label="Direct link to Setting Up Defaults" title="Direct link to Setting Up Defaults">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class PreferencesService {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final UserPreferencesManager _prefsManager;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PreferencesService(this._prefsManager);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Future&lt;void&gt; initializeDefaults() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _prefsManager.ensureDefaultPreferences({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;theme&#x27;: (value: &#x27;default&#x27;, valueType: UserPreferenceValueType.text),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;notifications_enabled&#x27;: (value: true, valueType: UserPreferenceValueType.boolean),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;user_score&#x27;: (value: 0.0, valueType: UserPreferenceValueType.real),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;favorite_categories&#x27;: (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value: [&#x27;general&#x27;], </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        valueType: UserPreferenceValueType.textArray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;user_settings&#x27;: (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &#x27;theme&#x27;: &#x27;default&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &#x27;darkMode&#x27;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &#x27;languages&#x27;: [&#x27;en&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        valueType: UserPreferenceValueType.jsonObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="app-initialization">App Initialization<a href="#app-initialization" class="hash-link" aria-label="Direct link to App Initialization" title="Direct link to App Initialization">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class MyApp extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return FutureBuilder(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      future: _initializeApp(ref),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      builder: (context, snapshot) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (snapshot.connectionState == ConnectionState.waiting) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return MaterialApp(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            home: Scaffold(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              body: Center(child: CircularProgressIndicator()),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return MaterialApp(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          title: &#x27;My App&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          home: HomeScreen(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Future&lt;void&gt; _initializeApp(WidgetRef ref) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final prefsManager = ref.read(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final preferencesService = PreferencesService(prefsManager);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await preferencesService.initializeDefaults();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-usage">Advanced Usage<a href="#advanced-usage" class="hash-link" aria-label="Direct link to Advanced Usage" title="Direct link to Advanced Usage">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="raw-preference-access">Raw Preference Access<a href="#raw-preference-access" class="hash-link" aria-label="Direct link to Raw Preference Access" title="Direct link to Raw Preference Access">​</a></h3>
<p>For debugging or advanced use cases, you can access raw preference data:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Get raw preference data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final rawData = await prefsManager.getRawPreference(&#x27;user_settings&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;Key: ${rawData?[&#x27;preference_key&#x27;]}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;Value: ${rawData?[&#x27;preference_value&#x27;]}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;Type: ${rawData?[&#x27;value_type&#x27;]}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Watch raw preference changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prefsManager.watchRawPreference(&#x27;user_settings&#x27;).listen((rawData) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (rawData != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Raw preference updated: $rawData&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="preference-deletion">Preference Deletion<a href="#preference-deletion" class="hash-link" aria-label="Direct link to Preference Deletion" title="Direct link to Preference Deletion">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Delete a specific preference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.deletePreference(&#x27;old_setting&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Check if preference exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final exists = await prefsManager.getRawPreference(&#x27;some_key&#x27;) != null;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling">Error Handling<a href="#error-handling" class="hash-link" aria-label="Direct link to Error Handling" title="Direct link to Error Handling">​</a></h3>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Robust preference retrieval with error handling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;UserSettings&gt; getUserSettings() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final settings = await prefsManager.getPreference&lt;UserSettings?&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      fromJson: (json) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (json == null) return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return UserSettings.fromJson(json as Map&lt;String, dynamic&gt;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return settings ?? UserSettings.defaultSettings();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Error loading user settings: $e&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return UserSettings.defaultSettings();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-use-riverpod-providers-recommended">1. Use Riverpod Providers (Recommended)<a href="#1-use-riverpod-providers-recommended" class="hash-link" aria-label="Direct link to 1. Use Riverpod Providers (Recommended)" title="Direct link to 1. Use Riverpod Providers (Recommended)">​</a></h3>
<p>Create dedicated providers for your preferences rather than accessing the
manager directly in widgets:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Good - Declarative and reactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final themeProvider = StreamProvider&lt;String&gt;((ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return prefsManager.watchPreference&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;theme&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJson: (json) =&gt; json as String? ?? &#x27;default&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Less ideal - Direct access in widget</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class SomeWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final prefsManager = ref.watch(userPreferencesManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return StreamBuilder&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stream: prefsManager.watchPreference&lt;String&gt;(&#x27;theme&#x27;, fromJson: ...),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-type-safety">2. Type Safety<a href="#2-type-safety" class="hash-link" aria-label="Direct link to 2. Type Safety" title="Direct link to 2. Type Safety">​</a></h3>
<p>Always use specific types and proper fromJson functions:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Good</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final count = await prefsManager.getPreference&lt;int&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;item_count&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (json) =&gt; json as int? ?? 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Avoid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final count = await prefsManager.getPreference&lt;dynamic&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;item_count&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (json) =&gt; json,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-consistent-value-types">3. Consistent Value Types<a href="#3-consistent-value-types" class="hash-link" aria-label="Direct link to 3. Consistent Value Types" title="Direct link to 3. Consistent Value Types">​</a></h3>
<p>Use the appropriate <code>UserPreferenceValueType</code> for your data:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Good - matches the actual data type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;categories&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [&#x27;tech&#x27;, &#x27;sports&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.textArray,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Avoid - inconsistent with data structure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;categories&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [&#x27;tech&#x27;, &#x27;sports&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valueType: UserPreferenceValueType.text, // Wrong type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-default-values">4. Default Values<a href="#4-default-values" class="hash-link" aria-label="Direct link to 4. Default Values" title="Direct link to 4. Default Values">​</a></h3>
<p>Always provide sensible defaults in your fromJson functions:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Good - handles null case</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final theme = await prefsManager.getPreference&lt;String&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;theme&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (json) =&gt; json as String? ?? &#x27;default&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Risky - could return null unexpectedly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final theme = await prefsManager.getPreference&lt;String?&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;theme&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fromJson: (json) =&gt; json as String?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-performance-considerations">5. Performance Considerations<a href="#5-performance-considerations" class="hash-link" aria-label="Direct link to 5. Performance Considerations" title="Direct link to 5. Performance Considerations">​</a></h3>
<ul>
<li>Use Riverpod providers for UI that needs real-time updates</li>
<li>Use one-time calls (<code>getPreference</code>) for initialization or infrequent access</li>
<li>Consider batching multiple preference updates when possible</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-migration-strategy">6. Migration Strategy<a href="#6-migration-strategy" class="hash-link" aria-label="Direct link to 6. Migration Strategy" title="Direct link to 6. Migration Strategy">​</a></h3>
<p>When changing preference structures, handle migration gracefully:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;UserSettings&gt; migrateUserSettings() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final settings = await prefsManager.getPreference&lt;UserSettings?&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJson: (json) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (json == null) return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Handle old format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (json is String) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return UserSettings(theme: json, darkMode: false, languages: [&#x27;en&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Handle new format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return UserSettings.fromJson(json as Map&lt;String, dynamic&gt;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Save in new format if migration occurred</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (settings != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await prefsManager.setPreference(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;user_settings&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      settings.toJson(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      valueType: UserPreferenceValueType.jsonObject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return settings ?? UserSettings.defaultSettings();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/flutter_tether/additional_features/auth_manager"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Auth Manager</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/flutter_tether/additional_features/background_manager"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Background Service: Background Job Processing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#supported-data-types" class="table-of-contents__link toc-highlight">Supported Data Types</a></li><li><a href="#setup--configuration" class="table-of-contents__link toc-highlight">Setup &amp; Configuration</a><ul><li><a href="#1-enable-in-configuration" class="table-of-contents__link toc-highlight">1. Enable in Configuration</a></li><li><a href="#2-generated-files" class="table-of-contents__link toc-highlight">2. Generated Files</a></li><li><a href="#3-database-schema" class="table-of-contents__link toc-highlight">3. Database Schema</a></li></ul></li><li><a href="#basic-usage" class="table-of-contents__link toc-highlight">Basic Usage</a><ul><li><a href="#accessing-the-manager" class="table-of-contents__link toc-highlight">Accessing the Manager</a></li><li><a href="#setting-preferences" class="table-of-contents__link toc-highlight">Setting Preferences</a></li><li><a href="#getting-preferences" class="table-of-contents__link toc-highlight">Getting Preferences</a></li></ul></li><li><a href="#reactive-ui-with-riverpod-providers" class="table-of-contents__link toc-highlight">Reactive UI with Riverpod Providers</a><ul><li><a href="#simple-preference-providers" class="table-of-contents__link toc-highlight">Simple Preference Providers</a></li><li><a href="#complex-object-providers" class="table-of-contents__link toc-highlight">Complex Object Providers</a></li><li><a href="#using-providers-in-widgets" class="table-of-contents__link toc-highlight">Using Providers in Widgets</a></li><li><a href="#provider-family-for-dynamic-keys" class="table-of-contents__link toc-highlight">Provider Family for Dynamic Keys</a></li></ul></li><li><a href="#reactive-ui-with-streambuilder-alternative" class="table-of-contents__link toc-highlight">Reactive UI with StreamBuilder (Alternative)</a><ul><li><a href="#watching-simple-preferences" class="table-of-contents__link toc-highlight">Watching Simple Preferences</a></li><li><a href="#watching-complex-objects" class="table-of-contents__link toc-highlight">Watching Complex Objects</a></li></ul></li><li><a href="#default-preferences" class="table-of-contents__link toc-highlight">Default Preferences</a><ul><li><a href="#setting-up-defaults" class="table-of-contents__link toc-highlight">Setting Up Defaults</a></li><li><a href="#app-initialization" class="table-of-contents__link toc-highlight">App Initialization</a></li></ul></li><li><a href="#advanced-usage" class="table-of-contents__link toc-highlight">Advanced Usage</a><ul><li><a href="#raw-preference-access" class="table-of-contents__link toc-highlight">Raw Preference Access</a></li><li><a href="#preference-deletion" class="table-of-contents__link toc-highlight">Preference Deletion</a></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error Handling</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a><ul><li><a href="#1-use-riverpod-providers-recommended" class="table-of-contents__link toc-highlight">1. Use Riverpod Providers (Recommended)</a></li><li><a href="#2-type-safety" class="table-of-contents__link toc-highlight">2. Type Safety</a></li><li><a href="#3-consistent-value-types" class="table-of-contents__link toc-highlight">3. Consistent Value Types</a></li><li><a href="#4-default-values" class="table-of-contents__link toc-highlight">4. Default Values</a></li><li><a href="#5-performance-considerations" class="table-of-contents__link toc-highlight">5. Performance Considerations</a></li><li><a href="#6-migration-strategy" class="table-of-contents__link toc-highlight">6. Migration Strategy</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Chad Specter.</div></div></div></footer></div>
</body>
</html>