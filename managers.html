<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-managers" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Managers | Flutter Tether</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://flutterTether.github.io/flutter_tether/img/ft-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://flutterTether.github.io/flutter_tether/img/ft-social-card.jpg"><meta data-rh="true" property="og:url" content="https://flutterTether.github.io/flutter_tether/managers"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Managers | Flutter Tether"><meta data-rh="true" name="description" content="Tether will create a Manager class for each table that is defined in the"><meta data-rh="true" property="og:description" content="Tether will create a Manager class for each table that is defined in the"><link data-rh="true" rel="icon" href="/flutter_tether/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://flutterTether.github.io/flutter_tether/managers"><link data-rh="true" rel="alternate" href="https://flutterTether.github.io/flutter_tether/managers" hreflang="en"><link data-rh="true" rel="alternate" href="https://flutterTether.github.io/flutter_tether/managers" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Managers","item":"https://flutterTether.github.io/flutter_tether/managers"}]}</script><link rel="stylesheet" href="/flutter_tether/assets/css/styles.0f514b2e.css">
<script src="/flutter_tether/assets/js/runtime~main.e7209d94.js" defer="defer"></script>
<script src="/flutter_tether/assets/js/main.c4f0b1ee.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/flutter_tether/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/flutter_tether/"><div class="navbar__logo"><img src="/flutter_tether/img/logo.svg" alt="Flutter Tether Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/flutter_tether/img/logo.svg" alt="Flutter Tether Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Flutter Tether</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/flutter_tether/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/cspecter/flutter_tether" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/intro">About Tether</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/schema">Schema Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/models">Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/select_builders">Select Builders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/flutter_tether/managers">Managers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/full_text_search">Full Text Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter_tether/config">Configuration Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/flutter_tether/category/additional-features">Additional Features</a><button aria-label="Expand sidebar category &#x27;Additional Features&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/flutter_tether/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Managers</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Managers</h1></header>
<p>Tether will create a <code>Manager</code> class for each table that is defined in the
schema. The Manager is in-essence a wrapper around the Supabase client API and
operates very much like the Supabase client API. It will automatically handle
caching data fetched from the remote database as well as automatically handle
optimistic updates for inserts, updates, and deletes.</p>
<p>All manager operations now return <code>TetherClientReturn&lt;TModel&gt;</code> objects that
include both data and metadata like count information.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-managers">Accessing Managers<a href="#accessing-managers" class="hash-link" aria-label="Direct link to Accessing Managers" title="Direct link to Accessing Managers">​</a></h2>
<p>After generation managers will be available in the <code>lib/database/managers</code>
directory.</p>
<p>The intended way to use the manager is via Riverpod, but you can also use it
directly with another state management solution or even without any state
management.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// With Riverpod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Without Riverpod - you have to pass some options in to the constructor, but you could then use it via GetIt or any other DI solution.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final bookManager = BooksManager(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    localDb: database.db, // The local SQLite database instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client: Supabase.instance.client, // The Supabase client instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tableSchemas: globalSupabaseSchema, // The global schema for the tables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromJsonFactory: (json) =&gt; BookModel.fromJson(json), // Factory to convert Supabase JSON to the model.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fromSqliteFactory: (json) =&gt; BookModel.fromSqlite(json), // Factory to convert SQLite JSON to the model.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tetherclientreturn">TetherClientReturn<a href="#tetherclientreturn" class="hash-link" aria-label="Direct link to TetherClientReturn" title="Direct link to TetherClientReturn">​</a></h2>
<p>All manager operations return a <code>TetherClientReturn&lt;TModel&gt;</code> object with the
following properties:</p>
<ul>
<li><code>data</code>: <code>List&lt;TModel&gt;</code> - The actual model instances</li>
<li><code>count</code>: <code>int?</code> - Total count of records matching the query (when available
from remote)</li>
<li><code>error</code>: <code>String?</code> - Error message if an error occurred</li>
<li><code>hasError</code>: <code>bool</code> - Convenience getter for checking if an error occurred</li>
<li><code>single</code>: <code>TModel</code> - Convenience getter for getting the first item (throws if
empty)</li>
</ul>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.query.select(BooksSelectBuilder().select());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Access the data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final books = result.data; // List&lt;BookModel&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final totalCount = result.count; // int? - total matching records</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final hasError = result.hasError; // bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Handle errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;Error: ${result.error}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get single item (throws if no data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final book = result.single; // First BookModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;No books found&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-usage">Basic Usage<a href="#basic-usage" class="hash-link" aria-label="Direct link to Basic Usage" title="Direct link to Basic Usage">​</a></h2>
<p>The Tether Manager API is almost identical to the Supabase client API, so if you
are familiar with the Supabase client API, you will feel right at home. It wraps
the following APIs:</p>
<ul>
<li>Database client API<!-- -->
<ul>
<li>RPC is supported, but see notes below.</li>
<li>Full-text search is supported, but see notes below.</li>
</ul>
</li>
<li>Realtime client API</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-client-api">Database Client API<a href="#database-client-api" class="hash-link" aria-label="Direct link to Database Client API" title="Direct link to Database Client API">​</a></h3>
<p>This will be the most commonly used API. It allows you to fetch data from
Supabase, cache it locally, and mutate it. You will use the same methods to also
fetch data from the local SQLite database.</p>
<p>You can use the <code>query()</code> method to create a query builder for the table, and
then use the <code>select()</code>, <code>insert()</code>, <code>update()</code>, and <code>delete()</code>, filter and
transform methods to build your query.</p>
<p>There are a few key differences to the Supabase client API:</p>
<ul>
<li>The <code>select()</code> method does not take a string, but rather a <code>SelectBuilder</code>
instance that allows you to build the select statement in a Tether manner.</li>
<li>The <code>insert()</code>, <code>update()</code>, <code>upsert()</code> and <code>delete()</code> methods take a list of
models (BookModel, AuthorModel, etc.) rather than a map of data. This allows
you to work with the models directly and ensures type safety.</li>
<li>Filters and Transforms, like <code>eq()</code>, <code>like()</code>, <code>order()</code>, etc., accept a
<code>TetherColumn</code> instance rather than a string. This allows you to use the
generated columns from the models directly, ensuring type safety and avoiding
typos.</li>
<li>On inserts and updates you do not need to pass the ending <code>.select()</code> to get
returning data like you would with the Supabase client API. Tether will
automatically return the inserted or updated data as models.</li>
<li><strong>All operations return <code>TetherClientReturn&lt;TModel&gt;</code></strong> which includes both
data and metadata.</li>
</ul>
<p>Some examples of how to use the Manager API:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Fetch all books with count information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.query.select(BooksSelectBuilder().select());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final books = result.data; // List&lt;BookModel&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final totalCount = result.count; // int? - total books in database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Fetch a single book by ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.query.select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .eq(BooksColumn.id, &#x27;some-book-id&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .limit(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;Error: ${result.error}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} else if (result.data.isNotEmpty) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final book = result.single; // Get the first (and only) book</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;Found book: ${book.title}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Insert a new book</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final newBook = BookModel(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id: &#x27;new-book-id&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  title: &#x27;New Book&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  authorId: &#x27;author-id&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // other fields...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final insertResult = await booksManager.query.insert([newBook]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final insertedBooks = insertResult.data; // List&lt;BookModel&gt; with the inserted book</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Update a book</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final updatedBook = BookModel(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id: &#x27;some-book-id&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  title: &#x27;Updated Book Title&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // other fields...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">); // You will typically want to pass in a mutated version of the whole model, not just the fields you want to update.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final updateResult = await booksManager.query.update([updatedBook])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .eq(BooksColumn.id, &#x27;some-book-id&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final updatedBooks = updateResult.data; // List&lt;BookModel&gt; with updated book</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Delete a book</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final deleteResult = await booksManager.query.delete()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .eq(BooksColumn.id, &#x27;some-book-id&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// deleteResult.data will be empty for delete operations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;Delete successful: ${!deleteResult.hasError}&#x27;);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="count-information-and-pagination">Count Information and Pagination<a href="#count-information-and-pagination" class="hash-link" aria-label="Direct link to Count Information and Pagination" title="Direct link to Count Information and Pagination">​</a></h4>
<p>The <code>count</code> field in <code>TetherClientReturn</code> provides valuable information for
pagination and UI:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Get books with pagination info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.query.select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .order(BooksColumn.createdAt, ascending: false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .limit(20);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final books = result.data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final totalAvailable = result.count; // Total books matching the query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;Showing ${books.length} of ${totalAvailable ?? &#x27;unknown&#x27;} books&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Use count for pagination decisions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final hasMorePages = totalAvailable != null &amp;&amp; books.length &lt; totalAvailable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (hasMorePages) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;More books available&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="streaming-data">Streaming Data<a href="#streaming-data" class="hash-link" aria-label="Direct link to Streaming Data" title="Direct link to Streaming Data">​</a></h4>
<p>You can use the same manager to create a <code>Stream</code> of your data by using
<code>asStream()</code> instead of <code>await</code> on the query. This will return a
<code>Stream&lt;TetherClientReturn&lt;TModel&gt;&gt;</code> that you can listen to for changes from the
local database. On initialization of the stream it will also fetch data from the
remote database and cache it locally.</p>
<p>Best practice is to define your streams in a Riverpod provider so that you can
easily listen to them in your widgets. This also allows you an easy way to pass
in options to the manager, such as listening to a specific item based on id.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Watch a single book by ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final bookProvider = StreamProvider.autoDispose.family&lt;TetherClientReturn&lt;BookModel&gt;, String&gt;((ref, bookId) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Fetch a single book by ID and listen for changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return booksManager.query.select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .eq(BooksColumn.id, bookId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .limit(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .asStream(); // Returns Stream&lt;TetherClientReturn&lt;BookModel&gt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// In your widget</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class BookWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final String bookId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BookWidget({required this.bookId});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final bookAsyncValue = ref.watch(bookProvider(bookId));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return bookAsyncValue.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: (result) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return Text(&#x27;Error: ${result.error}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (result.data.isEmpty) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          return Text(&#x27;Book not found&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final book = result.single;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          children: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Text(&#x27;Book title: ${book.title}&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (result.count != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              Text(&#x27;Total books: ${result.count}&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      loading: () =&gt; CircularProgressIndicator(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error: (error, stack) =&gt; Text(&#x27;Stream error: $error&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>For a simpler approach when you only need the data and don&#x27;t care about count or
errors in the stream:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Extract just the data from the stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final bookDataProvider = StreamProvider.autoDispose.family&lt;List&lt;BookModel&gt;, String&gt;((ref, bookId) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return booksManager.query.select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .eq(BooksColumn.id, bookId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .limit(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .asStream()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map((result) =&gt; result.data); // Extract just the data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Simpler widget usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class BookWidget extends ConsumerWidget {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final String bookId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BookWidget({required this.bookId});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Widget build(BuildContext context, WidgetRef ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final bookAsyncValue = ref.watch(bookDataProvider(bookId));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return bookAsyncValue.when(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: (books) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (books.isEmpty) return Text(&#x27;Book not found&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final book = books.first;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Text(&#x27;Book title: ${book.title}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      loading: () =&gt; CircularProgressIndicator(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error: (error, stack) =&gt; Text(&#x27;Error: $error&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>As all the mutations (insert, update, delete) are automatically optimistically
updated, you can listen to the stream and get real-time updates from the local
database without having to worry about the state of the remote database.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="local-or-remote-fetching">Local or Remote Fetching<a href="#local-or-remote-fetching" class="hash-link" aria-label="Direct link to Local or Remote Fetching" title="Direct link to Local or Remote Fetching">​</a></h4>
<p>You can use the <code>localOnly()</code> and <code>remoteOnly()</code> methods to tell the manager to
only fetch data from the local SQLite database or the remote Supabase database,
respectively. This is useful when you want to ensure you are only working with
the local data or when you want to bypass the local cache and fetch fresh data
from the remote database.</p>
<p>Note: All remote queries will automatically cache the data locally.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Fetch all books from the remote database only - useful if you are refreshing data you are watching via a Stream.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final remoteResult = await booksManager.query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .remoteOnly();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final remoteBooks = remoteResult.data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final totalRemoteCount = remoteResult.count; // Available when fetching from remote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Fetch from local only (count will be based on local data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final localResult = await booksManager.query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .localOnly();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final localBooks = localResult.data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final localCount = localResult.count; // Count of local data</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="relationships">Relationships<a href="#relationships" class="hash-link" aria-label="Direct link to Relationships" title="Direct link to Relationships">​</a></h4>
<p>Managers are smart and will automatically handle relationships, fetching and
caching the data for all the related items. Just pass in a SelectBuilder
instance to the <code>select()</code> method and use the <code>with*</code> methods to include related
items in the query.</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Fetch all books with their authors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .select(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BooksSelectBuilder().select()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .withAuthor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AuthorsSelectBuilder().select()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .eq(BooksColumn.id, &#x27;some-book-id&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final booksWithAuthors = result.data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final count = result.count;</span><br></span></code></pre></div></div>
<p>You can also query a table by columns on a related table. For example, if you
want to fetch all books by a specific author, you can do it like this:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Fetch all books by a specific author</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .withAuthor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AuthorsSelectBuilder().select()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ).eq(AuthorsColumn.name, &#x27;Author Name&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final booksByAuthor = result.data;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rpc-calls">RPC Calls<a href="#rpc-calls" class="hash-link" aria-label="Direct link to RPC Calls" title="Direct link to RPC Calls">​</a></h3>
<p>Tether supports calling Remote Procedure Calls (RPC) defined in your Supabase
project. RPC calls also return <code>TetherClientReturn&lt;TModel&gt;</code> objects. There are a
few things to note to make this work:</p>
<ul>
<li>RPCs are related to the table the Manager is for.</li>
<li>Because of this your stored procedure will need to return an Array of JSON
objects with columns that match that table in the database. This should look
the same as what the Supabase API returns for a table query.<!-- -->
<ul>
<li>For example, if you have a <code>books</code> table, your RPC should return an array of
objects with the same structure as the <code>books</code> table.</li>
<li>You can also return data from related tables, but you will need to make sure
it conforms to the structure that a Tether model expects (look at the
related Factory method in the model for the expected structure).</li>
</ul>
</li>
</ul>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Call an RPC that returns books</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.rpc(&#x27;get_books_by_author&#x27;, params: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;author_id&#x27;: &#x27;author-id&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}).select(BooksSelectBuilder().select());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final books = result.data; // List&lt;BookModel&gt; from RPC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final count = result.count; // Count if provided by RPC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;RPC Error: ${result.error}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="realtime-client-api">Realtime Client API<a href="#realtime-client-api" class="hash-link" aria-label="Direct link to Realtime Client API" title="Direct link to Realtime Client API">​</a></h2>
<p>Tether Managers also support the Supabase Realtime API. This allows you to
listen to changes in the database and get real-time updates in your app, all
cached locally.</p>
<p>The realtime features of the Tether Manager work similarly to the Supabase
Realtime API, but with a few differences:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Listen to changes in the books table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final booksStream = booksManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .realtime // Call the realtime method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .eq(BooksColumn.id, &#x27;some-book-id&#x27;) // Add all the filters and transforms next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .listen(); // Call .listen() to stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// The stream emits TetherClientReturn&lt;BookModel&gt; objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">booksStream.listen((result) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Realtime error: ${result.error}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final books = result.data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;Realtime update: ${books.length} books changed&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Using an in filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final booksStream = booksManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .realtime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .inFilter(BooksColumn.id, [&#x27;book-id-1&#x27;, &#x27;book-id-2&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .listen();</span><br></span></code></pre></div></div>
<ul>
<li>You can use the <code>realtime()</code> method to create a realtime query builder for the
table, and then use the same filters and transforms as you would with the
database client API.</li>
<li>Add all the filters and transforms before calling <code>listen()</code> (see
<a href="https://supabase.com/docs/reference/dart/stream" target="_blank" rel="noopener noreferrer">Supabase documentation</a>).</li>
<li>The Manager will automatically handle caching the data locally and return the
TetherModels for the items that changed.</li>
<li>By default, the realtime stream will return all changes to the table.</li>
<li><strong>Realtime streams emit <code>TetherClientReturn&lt;TModel&gt;</code> objects</strong> with the
changed data.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling-best-practices">Error Handling Best Practices<a href="#error-handling-best-practices" class="hash-link" aria-label="Direct link to Error Handling Best Practices" title="Direct link to Error Handling Best Practices">​</a></h2>
<p>With the new <code>TetherClientReturn</code> structure, error handling is more consistent:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// For awaited operations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final result = await booksManager.query.select(BooksSelectBuilder().select());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Handle the error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  showErrorDialog(result.error!);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Proceed with data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final books = result.data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// For streams</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final booksStream = booksManager.query.select(BooksSelectBuilder().select()).asStream();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">booksStream.listen((result) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Stream error: ${result.error}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Handle successful data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  updateUI(result.data, result.count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// In Riverpod providers, you can transform the stream to handle errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final safeBooksProvider = StreamProvider&lt;List&lt;BookModel&gt;&gt;((ref) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final booksManager = ref.watch(booksManagerProvider);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return booksManager.query.select(BooksSelectBuilder().select())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .asStream()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map((result) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (result.hasError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          throw Exception(result.error);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return result.data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre></div></div>
<p>This approach provides better error visibility and more consistent handling
across all manager operations.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/flutter_tether/select_builders"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Select Builders</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/flutter_tether/full_text_search"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Full Text Search</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#accessing-managers" class="table-of-contents__link toc-highlight">Accessing Managers</a></li><li><a href="#tetherclientreturn" class="table-of-contents__link toc-highlight">TetherClientReturn</a></li><li><a href="#basic-usage" class="table-of-contents__link toc-highlight">Basic Usage</a><ul><li><a href="#database-client-api" class="table-of-contents__link toc-highlight">Database Client API</a></li><li><a href="#rpc-calls" class="table-of-contents__link toc-highlight">RPC Calls</a></li></ul></li><li><a href="#realtime-client-api" class="table-of-contents__link toc-highlight">Realtime Client API</a></li><li><a href="#error-handling-best-practices" class="table-of-contents__link toc-highlight">Error Handling Best Practices</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Chad Specter.</div></div></div></footer></div>
</body>
</html>